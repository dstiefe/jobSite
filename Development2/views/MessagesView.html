<div class="inmodal">
    <div class="color-line"></div>
    <div class="modal-header">

        <div style="position:absolute; right: 30px; top: 10px;">
            <a ng-click="onClose()" ><span class="glyphicon close-icon hoverClick" style="font-size: 30px; color: red;">Ã—</span></a>
        </div>

        <div class="pull-left">
            {{toUserName}}
        </div>

        <div class="pull-right">
            {{job.title}}
        </div>

    </div>
    <div class="modal-body">



        <div class="row">
            <div class="col-md-12" style="max-height: 500px !important; overflow-y: auto !important;" scroll-glue>
                <div ng-show="messages.length == 0">
                    Not found messages
                </div>

                <accordion close-others="oneAtATime" >
                        <accordion-group ng-repeat="_message in messages track by $index" is-open="_message.open" >
                            <accordion-heading ng-click="_message.open = !_message.open">
                                <div>
                                <span class="pull-left">Message From: {{_message.from | limitTo: 20}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                <span class="text-center">{{_message.subject | limitTo: 50}}&nbsp;</span>
                                <span class="pull-right">&nbsp;{{ _message.createDate*1000 | date : "MMMM d - yyyy" }}&nbsp;&nbsp;&nbsp;<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-up': _message.open, 'glyphicon-chevron-down': !_message.open}"></i></span>
                                    </div>
                            </accordion-heading>
                            <p>Message From: {{_message.from}}</p>
                            <p>To: {{_message.to}}</p>
                            <p>Subject: {{_message.subject}}</p>
                            <p>{{_message.body}}</p>
                            <p><a href="" style="color: darkcyan;" ng-click="$parent.$parent.$parent.$parent.showReply=!$parent.$parent.$parent.$parent.showReply">Reply</a></p>
                        </accordion-group>
                </accordion>
            </div>

            <div class="col-md-12" style="background-color: #DEEBF7;" ng-show="showReply">
                <br />
                <div class="alert alert-success" role="alert" ng-show="successMessage">Successfully sended!</div>
                <div class="alert alert-danger" role="alert" ng-show="errorMessage">Error occured. {{errorMessage}}</div>

                <form name="sendForm" ng-submit="send(sendForm.$valid)" novalidate>

                    <div class="form-group">
                        To: {{toUserName}}
                    </div>

                    <div class="form-group">



                        <select id="selectedMessageTemplate"
                                 name="selectedMessageTemplate"
                                 ng-model="selectedMessageTemplate"
                                 class="form-control"
                                 ng-change="messageTemplateChanged()"
                                 ng-options="messageTemplate as messageTemplate.name for messageTemplate in messageTemplates"
                                 ng-show="isAdmin"
                        >
                            <option value="">Insert Template</option>
                        </select>

                        <!--<select  class="form-control" id="messageTemplate" name="messageTemplate" ng-model="selectedMessageTemplate" ng-change="messageTemplateChanged()">-->
                            <!--<option value="">Insert Template</option>-->
                            <!--<option ng-repeat="messageTemplate in messageTemplates" ng-selected="messageTemplate.id==selectedMessageTemplate.id" value="{{messageTemplate}}">{{messageTemplate.name}}</option>-->
                        <!--</select>-->
                    </div>

                    <div class="form-group">
                        <input type="text" ng-model="newMessage.subject" placeholder="Subject" name="subject" id="subject" class="form-control" required />
                        <span class="color-theme" ng-show="sendForm.subject.$error.required">Subject is required.</span>
                    </div>

                    <div class="form-group">
                        <textarea cols="40" rows="5" ng-model="newMessage.body" placeholder="Message" name="body" id="body" class="form-control" required></textarea>
                        <span class="color-theme" ng-show="sendForm.body.$error.required">Message is required.</span>
                    </div>

                    <div class="form-group">
                                <button class="btn btn-primary btn-md" type="submit">Send</button>
                                <button ng-click="cancel()" class="btn btn-default btn-md">Cancel</button>
                                <span ng-show="isAdmin">
                                    <input type="checkbox" ng-model="isSaveTemplate" /> Save Template
                                    <input type="text" placeholder="Name Template" class="form-control" ng-model="nameTemplate" style="display: inline;width: 200px;" />
                                </span>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>
